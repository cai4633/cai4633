---
title: 造轮子遇到的问题
date: 2020-12-24 18:53:15
categories: VUe
tags: ["Vue3"]
---

在 vue3 造轮子的过程中，我遇到了很多问题，这都是在平时在写业务代码时不常见的知识点。在写业务代码时，我主要关注的是**业务逻辑**，写出的代码质量相对不高。而在造轮子的过程中，我需要去抽象各种组件，会遇到各种形形色色的问题。总结归纳有助于不断的提高自己。

### 一、 使用 BackTop 组件传递 target（滚动容器）

当我们浏览 web 页面过长时，手动滚动回顶部需要的时间较长，这时可能就需要**返回页面顶部**的操作按钮。所以我就自己写了一个 BackTop 组件，该组件的具体用法[见文档](https://cai4633.gitee.io/mom-ui-doc/#/doc/backtop)。BackTop 组件使用时需要传递一个 target，这个参数是被监视滚动事件的元素，默认是 document。
一开始，我设计的是直接传递一个 ELEMENT_NODE 给 target。但在实际运行时，发现会报错。因为在**ELEMENT_NODE**被传递过来时，**ELEMENT_NODE 不一定已经被渲染**。

解决这个问题的方法很经典：**使用函数延迟代码执行**。我不再直接传递 ELEMENT_NODE ， 而是传递一个函数给 target。 该**函数的返回值是一个 ELEMENT_NODE** 。这样当我在 BackTop 组件 onMounted()时调用这个函数就可以适时的获取想要的 target。
